<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>ImapClient Constructor (String, Int32, String, String, AuthMethod, Boolean, RemoteCertificateValidationCallback)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:S22.Imap.ImapClient.#ctor(System.String,System.Int32,System.String,System.String,S22.Imap.AuthMethod,System.Boolean,System.Net.Security.RemoteCertificateValidationCallback)" /><meta name="Description" content="Initializes a new instance of the ImapClient class and connects to the specified port on the specified host, optionally using the Secure Socket Layer (SSL) security protocol and attempts to authenticate with the server using the specified authentication me" /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="S22.Imap" /><meta name="file" content="M_S22_Imap_ImapClient__ctor_1" /><meta name="guid" content="M_S22_Imap_ImapClient__ctor_1" /><xml><MSHelp:Attr Name="AssetID" Value="M:S22.Imap.ImapClient.#ctor(System.String,System.Int32,System.String,System.String,S22.Imap.AuthMethod,System.Boolean,System.Net.Security.RemoteCertificateValidationCallback)" /><MSHelp:TOCTitle Title="ImapClient Constructor (String, Int32, String, String, AuthMethod, Boolean, RemoteCertificateValidationCallback)" /><MSHelp:RLTitle Title="ImapClient Constructor (String, Int32, String, String, AuthMethod, Boolean, RemoteCertificateValidationCallback) (S22.Imap)" /><MSHelp:Keyword Index="A" Term="M:S22.Imap.ImapClient.#ctor(System.String,System.Int32,System.String,System.String,S22.Imap.AuthMethod,System.Boolean,System.Net.Security.RemoteCertificateValidationCallback)" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="S22.Imap.dll" /><MSHelp:Attr Name="APIName" Value="S22.Imap.ImapClient..ctor" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Initializes a new instance of the ImapClient class and connects to the specified port on the specified host, optionally using the Secure Socket Layer (SSL) security protocol and attempts to authenticate with th ..." /><MSHelp:Attr Name="AssemblyVersion" Value="2.7.4676.42752" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">S22.Imap Documentation</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">ImapClient Constructor (String, Int32, String, String, AuthMethod, Boolean, RemoteCertificateValidationCallback)</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">
            Initializes a new instance of the ImapClient class and connects to the specified port on
            the specified host, optionally using the Secure Socket Layer (SSL) security protocol and
            attempts to authenticate with the server using the specified authentication method and
            credentials.
            </div><p /><b>Namespace:</b> <a href="N_S22_Imap.htm">S22.Imap</a><br /><b>Assembly:</b> <span sdata="assembly">S22.Imap</span> (in S22.Imap.dll) Version: 2.7.4676.42752 (2.7.0.0)<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">ImapClient</span>(
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a> <span class="parameter">hostname</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">int</a> <span class="parameter">port</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a> <span class="parameter">username</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">string</a> <span class="parameter">password</span>,
	<a href="T_S22_Imap_AuthMethod.htm">AuthMethod</a> <span class="parameter">method</span> = <a href="T_S22_Imap_AuthMethod.htm">AuthMethod</a>.Login,
	<a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">bool</a> <span class="parameter">ssl</span> = <span class="keyword">false</span>,
	<a href="http://msdn2.microsoft.com/en-us/library/ms145054" target="_blank">RemoteCertificateValidationCallback</a> <span class="parameter">validate</span> = <span class="keyword">null</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="hostname"><dt><span class="parameter">hostname</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>String</a><br />The DNS name of the server to which you intend to connect.</dd></dl><dl paramName="port"><dt><span class="parameter">port</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/td2s409d" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Int32</a><br />The port number of the server to which you intend to connect.</dd></dl><dl paramName="username"><dt><span class="parameter">username</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>String</a><br />The username with which to login in to the IMAP server.</dd></dl><dl paramName="password"><dt><span class="parameter">password</span></dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/s1wwdcbf" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>String</a><br />The password with which to log in to the IMAP server.</dd></dl><dl paramName="method"><dt><span class="parameter">method</span> (Optional)</dt><dd>Type: <a href="T_S22_Imap_AuthMethod.htm">S22.Imap<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>AuthMethod</a><br />The requested method of authentication. Can be one of the values
            of the AuthMethod enumeration.</dd></dl><dl paramName="ssl"><dt><span class="parameter">ssl</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/a28wyd50" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Boolean</a><br />Set to true to use the Secure Socket Layer (SSL) security protocol.</dd></dl><dl paramName="validate"><dt><span class="parameter">validate</span> (Optional)</dt><dd>Type: <a href="http://msdn2.microsoft.com/en-us/library/ms145054" target="_blank">System.Net.Security<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>RemoteCertificateValidationCallback</a><br />Delegate used for verifying the remote Secure Sockets Layer
            (SSL) certificate which is used for authentication. Set this to null if not needed</dd></dl></div></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style="">
				This example demonstrates how to connect and login to an IMAP server.
				<span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">/* Connect to Gmail's IMAP server on port 993 using SSL */</span>
<span class="highlight-keyword">try</span> {
    ImapClient Client = <span class="highlight-keyword">new</span> ImapClient(<span class="highlight-literal">"imap.gmail.com"</span>, <span class="highlight-number">993</span>, <span class="highlight-literal">"My_Username"</span>,
        <span class="highlight-literal">"My_Password"</span>, <span class="highlight-keyword">true</span>, AuthMethod.Login);

    <span class="highlight-comment">/* Check if the server supports IMAP IDLE */</span>
    <span class="highlight-keyword">if</span>(Client.Supports(<span class="highlight-literal">"IDLE"</span>))
        Console.WriteLine(<span class="highlight-literal">"This server supports the IMAP4 IDLE specification"</span>);
    <span class="highlight-keyword">else</span>
        Console.WriteLine(<span class="highlight-literal">"This server does not support IMAP IDLE"</span>);

    <span class="highlight-comment">/* release resources */</span>
    Client.Dispose();
}
<span class="highlight-keyword">catch</span>(InvalidCredentialsException) {
    Console.WriteLine(<span class="highlight-literal">"The server rejected the supplied credentials"</span>);
}</pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/8xt94y6e" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentOutOfRangeException</a></td><td>The port parameter is not between MinPort
            and MaxPort.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/27426hcy" target="_blank">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>The hostname parameter is null.</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/hsh2dfbb" target="_blank">System.Net.Sockets<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SocketException</a></td><td>An error occurred while accessing the socket used for
            establishing the connection to the IMAP server. Use the ErrorCode property to obtain the
            specific error code</td></tr><tr><td><a href="http://msdn2.microsoft.com/en-us/library/szf0ccz1" target="_blank">System.Security.Authentication<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>AuthenticationException</a></td><td>An authentication
            error occured while trying to establish a secure connection.</td></tr><tr><td><a href="T_S22_Imap_BadServerResponseException.htm">S22.Imap<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>BadServerResponseException</a></td><td>Thrown if an unexpected response is received
            from the server upon connecting.</td></tr><tr><td><a href="T_S22_Imap_InvalidCredentialsException.htm">S22.Imap<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>InvalidCredentialsException</a></td><td>Thrown if authentication using the
            supplied credentials failed.</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="T_S22_Imap_ImapClient.htm">ImapClient Class</a></div><div class="seeAlsoStyle"><a href="AllMembers_T_S22_Imap_ImapClient.htm">ImapClient Members</a></div><div class="seeAlsoStyle"><a href="Overload_S22_Imap_ImapClient__ctor.htm">ImapClient Overload</a></div><div class="seeAlsoStyle"><a href="N_S22_Imap.htm">S22.Imap Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span></div></div></body></html>